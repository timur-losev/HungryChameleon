diff --git a/cocos2dx/platform/CCPlatformConfig.h b/cocos2dx/platform/CCPlatformConfig.h
index 8ae9f6d..2636298 100644
--- a/cocos2dx/platform/CCPlatformConfig.h
+++ b/cocos2dx/platform/CCPlatformConfig.h
@@ -84,7 +84,7 @@ Config of cocos2d-x project, per target platform.
 #endif
 
 // win32
-#if defined(WIN32) && defined(_WINDOWS)
+#if defined(WIN32) || defined(_WINDOWS)
     #undef  CC_TARGET_PLATFORM
     #define CC_TARGET_PLATFORM         CC_PLATFORM_WIN32
 #endif
diff --git a/cocos2dx/platform/win32/CCPlatformDefine.h b/cocos2dx/platform/win32/CCPlatformDefine.h
index 4422101..03a2181 100644
--- a/cocos2dx/platform/win32/CCPlatformDefine.h
+++ b/cocos2dx/platform/win32/CCPlatformDefine.h
@@ -11,6 +11,9 @@
     #define CC_DLL     __declspec(dllimport)
 #endif
 
+#undef CC_DLL
+#define CC_DLL
+
 #include <assert.h>
 
 #if CC_DISABLE_ASSERT > 0
diff --git a/cocos2dx/proj.win32/cocos2d.vcxproj b/cocos2dx/proj.win32/cocos2d.vcxproj
index c4c0cba..96f5adc 100644
--- a/cocos2dx/proj.win32/cocos2d.vcxproj
+++ b/cocos2dx/proj.win32/cocos2d.vcxproj
@@ -27,7 +27,7 @@
     <PlatformToolset Condition="'$(VisualStudioVersion)' == '12.0' and exists('$(MSBuildProgramFiles32)\Microsoft SDKs\Windows\v7.1A')">v120_xp</PlatformToolset>
   </PropertyGroup>
   <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
-    <ConfigurationType>DynamicLibrary</ConfigurationType>
+    <ConfigurationType>StaticLibrary</ConfigurationType>
     <CharacterSet>Unicode</CharacterSet>
     <PlatformToolset Condition="'$(VisualStudioVersion)' == '10.0'">v100</PlatformToolset>
     <PlatformToolset Condition="'$(VisualStudioVersion)' == '11.0'">v110</PlatformToolset>
